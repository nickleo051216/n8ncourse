<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ZN Studio â€” n8n å¯¦ä½œèª² å ±åè¡¨</title>
  <meta name="description" content="ZN Studioï¼šå¾é›¶é–‹å§‹ï¼Œç”¨ n8n æ‰“é€ å±¬æ–¼ä½ çš„ç¬¬ä¸€æ¢è‡ªå‹•åŒ–æµç¨‹ â€” å ±åè¡¨" />
  <style>
    /* --------- CSS æ¨£å¼ä¿æŒä¸è®Š --------- */
    :root{--accent:#0ea5a4;--dark:#0f1724;--muted:#6b7280;--card:#0b1220;--bg:#071026;font-family: "Noto Sans TC", system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;}
    *{box-sizing:border-box}
    body{margin:0;background: linear-gradient(180deg,#041227 0%, #071026 60%);color:#e6eef6;-webkit-font-smoothing:antialiased;padding:32px;min-height:100vh;}
    .container{max-width:980px;margin:0 auto;background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:12px;padding:28px;box-shadow: 0 8px 30px rgba(2,6,23,0.6);border:1px solid rgba(255,255,255,0.03);}
    header{display:flex;gap:16px;align-items:center;margin-bottom:20px}
    .hero-img{width:120px;height:80px;border-radius:8px;overflow:hidden;flex-shrink:0;box-shadow: 0 6px 20px rgba(0,0,0,0.5);display:flex;align-items:center;justify-content:center;}
    h1{font-size:20px;margin:0 0 4px 0}
    p.lead{margin:0;color:var(--muted);font-size:14px}
    .card{background:var(--card);padding:18px;border-radius:10px;margin-bottom:18px;border:1px solid rgba(255,255,255,0.03)}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px}
    label{display:block;font-size:13px;color:#cfe8ec;margin-bottom:6px}
    input[type="text"], input[type="email"], input[type="tel"], select, textarea{width:100%;padding:10px 12px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color: #e6eef6;outline:none;font-size:14px;}
    select{background-color: #0b1220;color: #e6eef6;}
    select option{background-color: #0b1220;color: #e6eef6;padding: 8px;}
    select:focus{border-color: #0ea5a4;box-shadow: 0 0 0 2px rgba(14, 165, 164, 0.1);}
    textarea{min-height:96px;resize:vertical;padding-top:10px}
    .small{font-size:13px;color:var(--muted);margin-top:6px}
    .radio-row{display:flex;gap:12px;align-items:center}
    .radio{display:flex;gap:8px;align-items:center;padding:8px 10px;border-radius:8px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.005));border:1px solid rgba(255,255,255,0.02)}
    .muted{color:var(--muted);font-size:13px}
    .actions{display:flex;gap:12px;align-items:center;justify-content:flex-end;margin-top:12px}
    button.primary{background:linear-gradient(90deg,var(--accent),#06b6d4);color:#052024;padding:12px 18px;border-radius:10px;border:none;font-weight:600;cursor:pointer;box-shadow:0 6px 18px rgba(13,148,136,0.18)}
    button.ghost{background:transparent;color:var(--muted);padding:10px 14px;border-radius:10px;border:1px solid rgba(255,255,255,0.03);cursor:pointer}
    
    /* æŠ˜ç–Šå€å¡Šæ¨£å¼ */
    .collapsible{background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.05);border-radius:8px;margin-top:12px;overflow:hidden;}
    .collapsible-header{display:flex;align-items:center;justify-content:space-between;padding:12px 14px;cursor:pointer;user-select:none;transition: background 0.2s;}
    .collapsible-header:hover{background:rgba(255,255,255,0.03);}
    .collapsible-title{display:flex;align-items:center;gap:8px;font-size:14px;color:#cfe8ec;font-weight:500;}
    .collapsible-arrow{font-size:12px;color:var(--muted);transition: transform 0.3s;}
    .collapsible.open .collapsible-arrow{transform: rotate(180deg);}
    .collapsible-content{max-height:0;overflow:hidden;transition: max-height 0.3s ease-out;}
    .collapsible.open .collapsible-content{max-height:800px;} /* å¢åŠ é«˜åº¦ä»¥å®¹ç´é•·å…§å®¹ */
    .collapsible-inner{padding:0 14px 14px 14px;}
    
    /* èª²ç¨‹ä»‹ç´¹åˆ—è¡¨æ¨£å¼ */
    .course-list-title {color: #0ea5a4; font-size: 14px; font-weight: 600; margin: 12px 0 6px 0;}
    .course-list {margin: 0; padding-left: 20px; font-size: 14px; color: #d1d5db; line-height: 1.6;}
    .course-list li {margin-bottom: 4px;}

    .bank-table{width:100%;border-collapse:collapse;margin-top:8px;}
    .bank-table td{padding:8px 0;border-bottom:1px solid rgba(255,255,255,0.04);font-size:14px;}
    .bank-table td:first-child{color:var(--muted);width:80px;}
    .bank-table td:last-child{color:#e6eef6;font-weight:500;}
    .bank-table tr:last-child td{border-bottom:none;}
    .bank-table .highlight{color:#0ea5a4;font-size:16px;font-weight:700;}
    .optional-tag{display:inline-block;background:rgba(107,114,128,0.2);color:#9ca3af;font-size:11px;padding:2px 6px;border-radius:4px;margin-left:6px;font-weight:normal;}
    .hint{display:flex;align-items:flex-start;gap:6px;margin-top:8px;padding:10px 12px;background:rgba(14,165,164,0.05);border-radius:6px;border:1px solid rgba(14,165,164,0.1);}
    .hint-icon{flex-shrink:0;font-size:14px;}
    .hint-text{font-size:13px;color:#9fe6e2;line-height:1.5;}
    
    /* Loading overlay */
    .loading-overlay{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:linear-gradient(180deg,#041227 0%, #071026 60%);z-index:9999;justify-content:center;align-items:center;}
    .loading-overlay.show{display:flex;}
    .loading-content{text-align:center;}
    .loading-logo{width:80px;height:80px;margin:0 auto 24px;background:linear-gradient(135deg,#0ea5a4,#06b6d4);border-radius:12px;display:flex;align-items:center;justify-content:center;box-shadow:0 6px 20px rgba(14,165,164,0.4);}
    .loading-logo-text{font-size:32px;font-weight:700;color:#052024;letter-spacing:3px;line-height:1;}
    .loading-logo-sub{font-size:9px;color:#052024;margin-top:4px;letter-spacing:2px;font-weight:600;}
    .loading-spinner{border:4px solid rgba(255,255,255,0.1);border-top:4px solid #0ea5a4;border-radius:50%;width:40px;height:40px;animation:spin 1s linear infinite;margin:0 auto 20px;}
    @keyframes spin{0%{transform:rotate(0deg);}100%{transform:rotate(360deg);}}
    .loading-text{font-size:16px;margin:0 0 8px 0;color:#e6eef6;}
    .loading-subtext{font-size:14px;color:#6b7280;margin:0;}
    
    @media (max-width:800px){.grid{grid-template-columns:1fr}header{flex-direction:row;gap:12px}.hero-img{width:96px;height:64px}.actions{flex-direction:column;align-items:stretch}.radio-row{flex-direction:column;align-items:stretch}}
  </style>
</head>
<body>
  <div class="loading-overlay" id="loadingOverlay">
    <div class="loading-content">
      <div class="loading-logo">
        <div>
          <div class="loading-logo-text">ZN</div>
          <div class="loading-logo-sub">STUDIO</div>
        </div>
      </div>
      <div class="loading-spinner"></div>
      <p class="loading-text">æ­£åœ¨å°å‘ç¶ ç•Œä»˜æ¬¾é é¢...</p>
      <p class="loading-subtext">è«‹ç¨å€™ï¼Œä¸è¦é—œé–‰æ­¤é é¢</p>
    </div>
  </div>

  <div class="container" role="main">
    <header>
      <div class="hero-img" style="background:linear-gradient(135deg,#0ea5a4,#06b6d4);box-shadow:0 6px 20px rgba(14,165,164,0.4);">
        <div style="text-align:center;"><div style="font-size:28px;font-weight:700;color:#052024;letter-spacing:3px;line-height:1;">ZN</div><div style="font-size:8px;color:#052024;margin-top:4px;letter-spacing:2px;font-weight:600;">STUDIO</div></div>
      </div>
      <div>
        <h1>ğŸš€ ZN Studio â€” å¾é›¶é–‹å§‹çš„ n8n å¯¦ä½œèª²ï¼ˆ12/20ï¼‰</h1>
        <p class="lead">å°ç­ 15 äºº â€¢ å°åŒ—å¸‚ä¸­æ­£å€è¨±æ˜Œè¡— 42 ä¹‹ 1 è™Ÿ 4 æ¨“ D æ•™å®¤ â€¢ 13:00â€“17:00</p>
      </div>
    </header>

    <section class="card course-intro" style="border:1px solid rgba(14,165,164,0.3);box-shadow:0 0 15px rgba(14,165,164,0.1);">
        <div style="text-align:center;margin-bottom:20px;">
            <h2 style="background:linear-gradient(90deg, #0ea5a4, #06b6d4);-webkit-background-clip:text;-webkit-text-fill-color:transparent;margin-bottom:8px;font-size:22px;">n8n åŸºç¤å¯¦æˆ°æ‡‰ç”¨ x Line OA å¤šå…ƒ AI æ‡‰ç”¨</h2>
            <p style="color:#cfe8ec;font-weight:500;margin:0;">ç”¨ä½ æ„æƒ³ä¸åˆ°çš„è§’åº¦ï¼Œæ•™ä½ æ€éº¼ç© n8nï¼</p>
        </div>

        <div style="margin-bottom:20px;border-radius:8px;overflow:hidden;border:1px solid rgba(255,255,255,0.1);">
            <img src="workflow_preview.png" alt="æ™ºèƒ½è¡Œäº‹æ›†åŠ©ç†å·¥ä½œæµ" style="width:100%;display:block;">
        </div>

        <div style="background:rgba(14,165,164,0.1);padding:16px;border-radius:8px;border:1px solid rgba(14,165,164,0.2);margin-bottom:12px;text-align:center;">
            <p style="margin:0;color:#e6eef6;line-height:1.6;">
                ğŸ <strong>ç¬¬ä¸€å ‚èª²æˆæœï¼š</strong><br>
                å¸¶è‘— <strong>æ™ºèƒ½è¡Œäº‹æ›†åŠ©ç†</strong> å›å®¶ï¼<br>
                <span style="font-size:13px;color:#9fe6e2;">(æ”¯æ´æ–‡å­— / åœ–ç‰‡è¾¨è­˜ / èªéŸ³è¾¨è­˜ã€MCP è‡ªå‹•æŸ¥è©¢èˆ‡æ–°å¢è¡Œäº‹æ›†)</span><br>
                <span style="font-size:12px;color:var(--muted);margin-top:4px;display:block;">* è‹¥æ™‚é–“å……è£•ï¼ŒåŠ ç¢¼å¯¦ä½œã€Œæ™ºèƒ½ AI æ©Ÿå™¨äººã€</span>
            </p>
        </div>

        <div class="collapsible" id="courseDetailCollapsible">
            <div class="collapsible-header" onclick="toggleCourseDetails()">
                <span class="collapsible-title">ğŸ“– æŸ¥çœ‹å®Œæ•´èª²ç¨‹ä»‹ç´¹ (é©åˆå°è±¡ / æ”¶ç©« / æº–å‚™)</span>
                <span class="collapsible-arrow">â–¼</span>
            </div>
            <div class="collapsible-content">
                <div class="collapsible-inner" style="padding-top:10px;">
                    
                    <div class="course-list-title">ğŸ¤” é©åˆæ€éº¼æ¨£çš„äººï¼Ÿ</div>
                    <ul class="course-list">
                        <li>å®Œå…¨æ²’è½é n8nï¼Œå¥½å¥‡æ˜¯ä»€éº¼</li>
                        <li>æœ‰è½éä½†ä¸çŸ¥é“æ€éº¼é–‹å§‹ï¼Œæƒ³èªè­˜å­¸ç¿’ n8n</li>
                        <li>æœ‰è‡ªå­¸ï¼Œä¸éä¸ç¢ºå®šæœ‰æ²’æœ‰å­¸åˆ°å®Œæ•´</li>
                    </ul>

                    <div class="course-list-title">ğŸ¯ åƒåŠ ä¹‹å¾Œå¯ä»¥å­¸åˆ°</div>
                    <ul class="course-list">
                        <li>è‡³å°‘ä¸€æ¢å®Œæ•´çš„ n8n å·¥ä½œæµï¼ˆå¯ä»¥ç›´æ¥å¸¶å›å»ç©ï¼‰</li>
                        <li>èæœƒè²«é€šï¼Œç”šè‡³è‡ªå·±å›å»å®¢è£½åŒ–èª¿æ•´ï¼ˆèª²å ‚ä¸Šæ•™ä½ å¦‚ä½•æ’é™¤å•é¡Œï¼‰</li>
                        <li>ç”¨æœ€æ„æƒ³ä¸åˆ°çš„è§’åº¦å­¸æœƒ n8nï¼ˆç”šè‡³å¯ä»¥é–‹å§‹ä»‹ç´¹çµ¦å…¶ä»–äººï¼‰</li>
                        <li>åŠ å…¥å°ˆå±¬èª²å ‚ç¾¤çµ„</li>
                    </ul>

                    <div class="course-list-title">ğŸ’» èª²å‰æº–å‚™ (å»ºè­°)</div>
                    <ul class="course-list">
                        <li>å¸Œæœ›æœ‰ Zeabur çš„å¸³è™Ÿï¼ˆå¦‚æœ n8n éƒ¨ç½²å®Œæˆæœƒæ›´å¥½ï¼‰</li>
                        <li>æœ‰ OPENAI API (æˆ–æ˜¯ OpenRouter API)</li>
                        <li>æœ‰ Line å®˜æ–¹å¸³è™Ÿ (Messaging API)</li>
                    </ul>

                </div>
            </div>
        </div>
    </section>

    <form id="signupForm" class="card" autocomplete="on">
      <section class="card">
        <h2 style="margin:0 0 8px 0;font-size:15px">ä¸€ã€åŸºæœ¬è³‡æ–™</h2>
        <div class="grid">
          <div><label for="name">å§“åï¼ˆå¿…å¡«ï¼‰</label><input id="name" name="name" type="text" placeholder="è«‹å¡«å¯«çœŸå¯¦å§“å" required /></div>
          <div><label for="phone">è¯çµ¡é›»è©±ï¼ˆå¿…å¡«ï¼‰</label><input id="phone" name="phone" type="tel" placeholder="09xx-xxx-xxx" required /></div>
          <div><label for="email">Emailï¼ˆå¿…å¡«ï¼‰</label><input id="email" name="email" type="email" placeholder="name@example.com" required /></div>
          <div><label for="line">LINE IDï¼ˆé¸å¡«ï¼‰</label><input id="line" name="line" type="text" placeholder="LINE ID" /></div>
          <div><label for="company">å…¬å¸ï¼å–®ä½ï¼ˆé¸å¡«ï¼‰</label><input id="company" name="company" type="text" placeholder="å…¬å¸æˆ–å–®ä½" /></div>
          <div><label for="title">è·ç¨±ï¼ˆé¸å¡«ï¼‰</label><input id="title" name="title" type="text" placeholder="è·ç¨±" /></div>
        </div>
      </section>

      <section class="card">
        <h2 style="margin:0 0 8px 0;font-size:15px">äºŒã€å ±åè³‡è¨Š</h2>
        <label for="course">æ¬²å ±åèª²ç¨‹ï¼ˆå¿…é¸ï¼‰</label>
        <select id="course" name="course" required><option value="">-- é¸æ“‡èª²ç¨‹ --</option><option value="n8n-intro-20251220">ZN Studioï½œn8n å¯¦ä½œå…¥é–€ï¼ˆ2025/12/20ï¼‰</option></select>
        <div style="margin-top:12px">
          <label for="qty">å ±åäººæ•¸</label>
          <select id="qty" name="qty" required><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="other">å…¶ä»–ï¼ˆè«‹è¨»æ˜ï¼‰</option></select>
          <div id="otherQtyWrap" style="display:none;margin-top:8px"><input id="otherQty" name="otherQty" type="text" placeholder="è«‹è¼¸å…¥äººæ•¸" /></div>
        </div>
      </section>

      <section class="card">
        <h2 style="margin:0 0 8px 0;font-size:15px">ä¸‰ã€ä»˜æ¬¾æ–¹å¼ï¼ˆå¿…é¸ï¼‰</h2>
        <div class="radio-row">
          <label class="radio"><input type="radio" name="payMethod" value="ecpay" checked /> <span class="muted">ç¶ ç•Œé‡‘æµï¼ˆä¿¡ç”¨å¡ / ATM / è¶…å•†ï¼‰</span></label>
          <label class="radio"><input type="radio" name="payMethod" value="bank" /> <span class="muted">éŠ€è¡ŒåŒ¯æ¬¾</span></label>
        </div>
        <div id="ecpayBox" style="margin-top:12px">
          <p class="small">é¸æ“‡ç¶ ç•Œé‡‘æµå¾Œï¼Œè¡¨å–®é€å‡ºæœƒå°å‘ç¶ ç•Œçµå¸³é å®Œæˆä»˜æ¬¾ã€‚</p>
          <div style="margin-top:8px" class="grid"><div><label for="ecpayMethod">ä»˜æ¬¾æ–¹å¼ï¼ˆç¶ ç•Œï¼‰</label><select id="ecpayMethod" name="ecpayMethod"><option value="credit">ä¿¡ç”¨å¡</option><option value="atm">ATM è½‰å¸³</option><option value="convenience">è¶…å•†ä»£ç¢¼</option></select></div></div>
        </div>
        <div id="bankBox" style="display:none;margin-top:12px">
          <div class="collapsible" id="bankInfoCollapsible">
            <div class="collapsible-header" onclick="toggleBankInfo()"><span class="collapsible-title"><span>ğŸ¦</span><span>æŸ¥çœ‹åŒ¯æ¬¾å¸³è™Ÿè³‡è¨Š</span></span><span class="collapsible-arrow">â–¼</span></div>
            <div class="collapsible-content"><div class="collapsible-inner">
              <table class="bank-table"><tr><td>éŠ€è¡Œ</td><td>åœ‹æ³°ä¸–è¯éŠ€è¡Œï¼ˆ013ï¼‰</td></tr><tr><td>åˆ†è¡Œ</td><td>ä¸­å’Œåˆ†è¡Œ</td></tr><tr><td>æˆ¶å</td><td>å¼µå®¶å¯§</td></tr><tr><td>å¸³è™Ÿ</td><td>012345678901234</td></tr><tr><td>é‡‘é¡</td><td class="highlight">NT$ 2,999</td></tr></table>
            </div></div>
          </div>
          <div style="margin-top:16px"><label for="bankLast5">åŒ¯æ¬¾å¸³è™Ÿæœ« 5 ç¢¼<span class="optional-tag">é¸å¡«</span></label><input id="bankLast5" name="bankLast5" type="text" placeholder="ä¾‹å¦‚ï¼š12345" maxlength="5" /><div class="small">å·²å®ŒæˆåŒ¯æ¬¾è€…è«‹å¡«å¯«ï¼Œæ–¹ä¾¿æˆ‘å€‘æ ¸å°æ¬¾é …</div></div>
          <div class="hint"><span class="hint-icon">ğŸ’¡</span><span class="hint-text"><strong>é‚„æ²’åŒ¯æ¬¾ï¼Ÿ</strong>æ²’é—œä¿‚ï¼é€å‡ºå ±åå¾Œæœƒé¡¯ç¤ºå®Œæ•´åŒ¯æ¬¾è³‡è¨Šï¼Œè«‹æ–¼ <strong>3 å¤©å…§</strong> å®ŒæˆåŒ¯æ¬¾å³å¯ã€‚</span></div>
        </div>
      </section>

      <section class="card">
        <h2 style="margin:0 0 8px 0;font-size:15px">å››ã€ç™¼ç¥¨è³‡è¨Š</h2>
        <div style="display:flex;gap:12px;align-items:center"><label><input type="radio" name="invType" value="two" checked /> äºŒè¯å¼ï¼ˆå€‹äººï¼‰</label><label><input type="radio" name="invType" value="three" /> ä¸‰è¯å¼ï¼ˆå…¬å¸ï¼‰</label></div>
        <div id="threeInvoice" style="display:none;margin-top:10px"><label for="vatTitle">å…¬å¸æŠ¬é ­</label><input id="vatTitle" name="vatTitle" type="text" placeholder="å…¬å¸æŠ¬é ­" /><label for="vatNo" style="margin-top:8px">çµ±ä¸€ç·¨è™Ÿ</label><input id="vatNo" name="vatNo" type="text" placeholder="çµ±ç·¨" /></div>
        <div style="margin-top:8px"><label for="invEmail">ç™¼ç¥¨æ¥æ”¶ Emailï¼ˆè‹¥ç‚ºé›»å­ç™¼ç¥¨ï¼‰</label><input id="invEmail" name="invEmail" type="email" placeholder="receipt@example.com" /></div>
      </section>

      <section class="card">
        <h2 style="margin:0 0 8px 0;font-size:15px">äº”ã€å…¶ä»–å‚™è¨»</h2>
        <textarea id="remark" name="remark" placeholder="ç‰¹æ®Šéœ€æ±‚ã€é£²é£Ÿç¦å¿Œã€åŒå ´å ±åç­‰è«‹è¨»æ˜ï¼ˆé¸å¡«ï¼‰"></textarea>
      </section>

      <div class="actions"><button type="button" class="ghost" onclick="resetForm()">é‡è¨­è¡¨å–®</button><button type="submit" class="primary" id="submitBtn">æäº¤å ±å</button></div>
      <div style="margin-top:12px" class="small">æäº¤å¾Œè«‹ç•™æ„ Email æˆ– Lineï¼Œæˆ‘å€‘å°‡æ–¼ 1â€“2 å€‹å·¥ä½œå¤©å…§ç¢ºèªå ±åç‹€æ…‹ã€‚</div>
    </form>

    <footer style="margin-top:18px;text-align:center;color:var(--muted);font-size:13px">ZN Studio â€¢ å°ç­å¯¦ä½œèª²ï¼ˆåé¡æœ‰é™ï¼‰â€¢ å¦‚éœ€ç™¼ç¥¨æˆ–æ”¶æ“šè«‹æ–¼å ±åæ™‚å‘ŠçŸ¥</footer>
  </div>

  <form id="ecpayForm" method="POST" action="https://payment.ecpay.com.tw/Cashier/AioCheckOut/V5" style="display:none;"></form>

  <script>
    var N8N_WEBHOOK_URL = "https://nickleo9.zeabur.app/webhook/course-registration";
    var ECPAY_URL = "https://payment.ecpay.com.tw/Cashier/AioCheckOut/V5";
    
    var form = document.getElementById('signupForm');
    var payRadios = document.getElementsByName('payMethod');
    var bankBox = document.getElementById('bankBox');
    var ecpayBox = document.getElementById('ecpayBox');
    var qtySelect = document.getElementById('qty');
    var otherQtyWrap = document.getElementById('otherQtyWrap');
    var submitBtn = document.getElementById('submitBtn');
    var invTypeRadios = document.getElementsByName('invType');
    var threeInvoice = document.getElementById('threeInvoice');
    var loadingOverlay = document.getElementById('loadingOverlay');
    var ecpayForm = document.getElementById('ecpayForm');

    function updatePayUI() {
      var radios = Array.prototype.slice.call(payRadios);
      var checked = radios.find(function(r) { return r.checked; });
      var v = checked ? checked.value : 'ecpay';
      bankBox.style.display = v === 'bank' ? 'block' : 'none';
      ecpayBox.style.display = v === 'bank' ? 'none' : 'block';
    }
    
    var payRadiosArr = Array.prototype.slice.call(payRadios);
    payRadiosArr.forEach(function(r) { r.addEventListener('change', updatePayUI); });
    updatePayUI();

    function toggleBankInfo() { 
      document.getElementById('bankInfoCollapsible').classList.toggle('open'); 
    }

    // æ–°å¢ï¼šèª²ç¨‹è©³æƒ…æŠ˜ç–Šé–‹é—œ
    function toggleCourseDetails() {
      document.getElementById('courseDetailCollapsible').classList.toggle('open');
    }

    qtySelect.addEventListener('change', function() {
      otherQtyWrap.style.display = qtySelect.value === 'other' ? 'block' : 'none';
      if (qtySelect.value !== 'other') document.getElementById('otherQty').value = '';
    });

    var invRadiosArr = Array.prototype.slice.call(invTypeRadios);
    invRadiosArr.forEach(function(r) { 
      r.addEventListener('change', function() { 
        threeInvoice.style.display = r.value === 'three' ? 'block' : 'none'; 
      }); 
    });

    function resetForm(){
      if (!confirm('ç¢ºå®šè¦é‡è¨­è¡¨å–®å—ï¼Ÿ')) return;
      form.reset(); 
      updatePayUI(); 
      otherQtyWrap.style.display = 'none'; 
      threeInvoice.style.display = 'none';
      document.getElementById('bankInfoCollapsible').classList.remove('open');
      document.getElementById('courseDetailCollapsible').classList.remove('open'); // é‡è¨­æ™‚ä¹Ÿé—œé–‰èª²ç¨‹ä»‹ç´¹
    }

    // å»ºç«‹ä¸¦æäº¤ ECPay è¡¨å–®
    function submitToECPay(params) {
      ecpayForm.innerHTML = '';
      ecpayForm.action = ECPAY_URL;
      var keys = Object.keys(params);
      for (var i = 0; i < keys.length; i++) {
        var key = keys[i];
        var input = document.createElement('input');
        input.type = 'hidden';
        input.name = key;
        input.value = params[key];
        ecpayForm.appendChild(input);
      }
      console.log('ECPay Form Action:', ecpayForm.action);
      console.log('ECPay Params:', params);
      ecpayForm.submit();
    }

    form.addEventListener('submit', function(ev) {
      ev.preventDefault();
      submitBtn.disabled = true; 
      submitBtn.textContent = 'æ­£åœ¨è™•ç†...';
      
      var name = document.getElementById('name').value.trim();
      var phone = document.getElementById('phone').value.trim();
      var email = document.getElementById('email').value.trim();
      var course = document.getElementById('course').value;
      
      if (!name || !phone || !email || !course) { 
        alert('è«‹å¡«å¯«å§“åã€é›»è©±ã€Email èˆ‡æ¬²å ±åèª²ç¨‹ã€‚'); 
        submitBtn.disabled = false; 
        submitBtn.textContent = 'æäº¤å ±å'; 
        return; 
      }
      
      var bankLast5 = document.getElementById('bankLast5').value.trim();
      var payMethodEl = document.querySelector('input[name="payMethod"]:checked');
      var payMethod = payMethodEl ? payMethodEl.value : 'ecpay';
      var invTypeEl = document.querySelector('input[name="invType"]:checked');
      var invType = invTypeEl ? invTypeEl.value : 'two';
      
      var formData = { 
        name: name, 
        email: email, 
        phone: phone, 
        line: document.getElementById('line').value.trim() || '', 
        company: document.getElementById('company').value.trim() || '', 
        title: document.getElementById('title').value.trim() || '', 
        course: course, 
        qty: document.getElementById('qty').value, 
        otherQty: document.getElementById('otherQty').value || '', 
        payMethod: payMethod, 
        ecpayMethod: document.getElementById('ecpayMethod').value || '', 
        bankLast5: bankLast5, 
        invType: invType, 
        vatTitle: document.getElementById('vatTitle').value || '', 
        vatNo: document.getElementById('vatNo').value || '', 
        invEmail: document.getElementById('invEmail').value || '', 
        remark: document.getElementById('remark').value.trim() || '' 
      };
      
      fetch(N8N_WEBHOOK_URL, { 
        method: 'POST', 
        headers: { 'Content-Type': 'application/json' }, 
        body: JSON.stringify(formData) 
      })
      .then(function(response) {
        if (!response.ok) throw new Error('HTTP error: ' + response.status);
        return response.json();
      })
      .then(function(result) {
        console.log('n8n Response:', result);
        
        if (result.success) {
          if (payMethod === 'ecpay' && result.ecpayParams) {
            loadingOverlay.classList.add('show');
            setTimeout(function() {
              submitToECPay(result.ecpayParams);
            }, 300);
          } else {
            if (bankLast5 && bankLast5.length === 5) {
              window.location.href = 'https://nickleo051216.github.io/n8ncourse/course-success.html?order=' + result.orderId + '&name=' + encodeURIComponent(name) + '&status=pending';
            } else {
              window.location.href = 'https://nickleo051216.github.io/n8ncourse/bank-success.html?order=' + result.orderId + '&name=' + encodeURIComponent(name);
            }
          }
        } else { 
          alert('âŒ å ±åå¤±æ•—ï¼š' + (result.error || 'æœªçŸ¥éŒ¯èª¤')); 
          submitBtn.disabled = false; 
          submitBtn.textContent = 'æäº¤å ±å';
        }
      })
      .catch(function(error) { 
        console.error('Submit Error:', error);
        alert('âŒ é€å‡ºå¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦æˆ–è¯çµ¡ä¸»è¾¦æ–¹ã€‚\n\néŒ¯èª¤è¨Šæ¯ï¼š' + error.message + '\n\nè¯çµ¡æ–¹å¼ï¼š\nEmail: nickleo051216@gmail.com\nLine: https://lin.ee/Faz0doj'); 
        submitBtn.disabled = false; 
        submitBtn.textContent = 'æäº¤å ±å';
      });
    });
  </script>
</body>
</html>
